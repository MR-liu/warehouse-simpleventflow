{"version":3,"file":"index.js","sources":["../lib/AsyncParallelHook.js","../lib/AsyncParallelHookPromise.js","../lib/AsyncSeriesHook.js","../lib/AsyncSeriesHookPromise.js","../lib/AsyncSeriesWaterfallHook.js","../lib/SyncBailHook.js","../lib/SyncHook.js","../lib/SyncLoopHook.js","../lib/SyncWaterfallHook.js","../lib/index.js"],"sourcesContent":["class AsyncParallelHook{\n  constructor(...args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tapAsync(name, task){\n    this.tasks.push(task)\n  }\n  callAsync(...args) {\n    const finnally = args.pop(); // 把最后要执行的先取出来\n    let index = 0;\n\n    const done = () => {\n      index++\n      if (index == this.tasks.length) {\n        finnally();\n      }\n    }\n\n    this.tasks.forEach(task => {\n      task(...args, done)\n    })\n  }\n}\n\nexport default AsyncParallelHook;","class AsyncParallelHookPromise{\n  constructor(...args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tapPromise(name, task){\n    this.tasks.push(task)\n  }\n  promise(...args) {\n    const tasks = this.tasks.map(task => task(...args))\n    return Promise.all(tasks);\n  }\n}\n\nexport default AsyncParallelHookPromise;","class AsyncSeriesHook {\n  constructor(...args){\n    this.args = args;\n    this.tasks = [];\n  }\n  tapAsync(name, task) {\n    this.tasks.push(task);\n  }\n  callAsync(...args) {\n    const finnly = args.pop(); // 先把最后一个取出来\n    let index = 0;\n    const next = () => {// 递归传递下一个执行\n      if (index === this.tasks.length) {\n        return finnly()\n      }\n      const task = this.tasks[index++]\n      task(...args, next)\n    }\n    next();\n  }\n}\n\nexport default AsyncSeriesHook;","class AsyncSeriesHookPromise {\n  constructor(...args){\n    this.args = args;\n    this.tasks = [];\n  }\n  tapPromise(name, task) {\n    this.tasks.push(task);\n  }\n  promise(...args) {\n    const [first, ...others] = this.tasks;\n\n    return others.reduce((p, n) => {\n      return p.then(() => n(...args), () => ( console.log('error')))\n    }, first(...args))\n  }\n}\n\nexport default AsyncSeriesHookPromise;","class AsyncSeriesWaterfallHook{\n  constructor(...args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tapAsync(name, task) {\n    this.tasks.push(task)\n  }\n  callAsync(...args){\n    const finallycb = args.pop();\n    let index = 0;\n    const next = (err, data) => {\n      let task = this.tasks[index];\n      if (!task) {\n        return finallycb(...args)\n      }\n      if (index === 0) {\n        task(...args, next)\n      } else {\n        task(data, next)\n      }\n      index++\n    }\n    next()\n  }\n}\n\nexport default AsyncSeriesWaterfallHook;","class SyncBailHook{\n  constructor(args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tap(name, task) {\n    this.tasks.push(task)\n  }\n  call(...args) {\n    args = args.slice(0, this.args.length);\n\n    let i = 0, ret;\n\n    do {\n      ret = this.tasks[i++](...args)\n    } while (!ret && i < this.tasks.length);\n  }\n}\n\nexport default SyncBailHook;","class SyncHook{\n  constructor(args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tap(name, task) {\n    this.tasks.push(task)\n  }\n  call(...args) {\n    this.tasks.forEach(task => task(...args))\n  }\n}\n\nexport default SyncHook;","class SyncLoopHook{\n  constructor(args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tap(name, task) {\n    this.tasks.push(task)\n  }\n  call(...args) {\n    console.log(this.tasks, args)\n    this.tasks.forEach(fn => {\n      let ret;\n      do {\n        ret = fn(...args)\n      } while (ret != undefined);\n    })\n  }\n}\n\nexport default SyncLoopHook;","class SyncWaterfallHook{\n  constructor(args) {\n    this.args = args;\n    this.tasks = [];\n  }\n  tap(name, task) {\n    this.tasks.push(task)\n  }\n  call(...args) {\n    args = args.slice(0, this.args.length);\n\n    const [first, ...others] = this.tasks;\n\n    others.reduce((prams, fn) => {\n      return fn(prams)\n    }, first(...args));\n  }\n}\n\nexport default SyncWaterfallHook;\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\nimport AsyncParallelHook from './AsyncParallelHook'\nimport AsyncParallelHookPromise from './AsyncParallelHookPromise'\nimport AsyncSeriesHook from './AsyncSeriesHook'\nimport AsyncSeriesHookPromise from './AsyncSeriesHookPromise'\nimport AsyncSeriesWaterfallHook from './AsyncSeriesWaterfallHook'\nimport SyncBailHook from './SyncBailHook'\nimport SyncHook from './SyncHook'\nimport SyncLoopHook from './SyncLoopHook'\nimport SyncWaterfallHook from './SyncWaterfallHook'\n\nexports.__esModule = true;\nexports.AsyncParallelHook = AsyncParallelHook;\nexports.AsyncParallelHookPromise = AsyncParallelHookPromise;\nexports.AsyncSeriesHook = AsyncSeriesHook;\nexports.AsyncSeriesHookPromise = AsyncSeriesHookPromise;\nexports.AsyncSeriesWaterfallHook = AsyncSeriesWaterfallHook;\nexports.SyncBailHook = SyncBailHook;\nexports.SyncHook = SyncHook;\nexports.SyncLoopHook = SyncLoopHook;\nexports.SyncWaterfallHook = SyncWaterfallHook;\n\n"],"names":["AsyncParallelHook","args","tasks","name","task","push","done","index","_this","length","finnally","pop","forEach","AsyncParallelHookPromise","this","map","Promise","all","AsyncSeriesHook","finnly","next","AsyncSeriesHookPromise","first","reduce","p","n","then","console","log","AsyncSeriesWaterfallHook","finallycb","err","data","SyncBailHook","slice","ret","i","SyncHook","SyncLoopHook","fn","undefined","SyncWaterfallHook","prams","exports","__esModule"],"mappings":"qtDAAMA,6FACWC,2BAAAA,uBACRA,KAAOA,OACPC,MAAQ,yDAENC,EAAMC,QACRF,MAAMG,KAAKD,yEAELH,2BAAAA,kBAIE,SAAPK,MACJC,GACaC,EAAKN,MAAMO,QACtBC,QANEA,EAAWT,EAAKU,MAClBJ,EAAQ,OASPL,MAAMU,QAAQ,SAAAR,GACjBA,eAAQH,UAAMK,gBCpBdO,oGACWZ,2BAAAA,uBACRA,KAAOA,OACPC,MAAQ,2DAEJC,EAAMC,QACVF,MAAMG,KAAKD,gEAEPH,2BAAAA,sBACHC,EAAQY,KAAKZ,MAAMa,IAAI,SAAAX,UAAQA,eAAQH,YACtCe,QAAQC,IAAIf,YCVjBgB,2FACWjB,2BAAAA,uBACRA,KAAOA,OACPC,MAAQ,yDAENC,EAAMC,QACRF,MAAMG,KAAKD,yEAELH,2BAAAA,sBACLkB,EAASlB,EAAKU,MAChBJ,EAAQ,GACC,SAAPa,OACAb,IAAUC,EAAKN,MAAMO,cAChBU,IAEIX,EAAKN,MAAMK,kBAChBN,UAAMmB,KAEhBA,YClBEC,kGACWpB,2BAAAA,uBACRA,KAAOA,OACPC,MAAQ,2DAEJC,EAAMC,QACVF,MAAMG,KAAKD,gEAEPH,2BAAAA,iCACkBa,KAAKZ,OAAzBoB,yBAEOC,OAAO,SAACC,EAAGC,UAChBD,EAAEE,KAAK,kBAAMD,eAAKxB,IAAO,kBAAQ0B,QAAQC,IAAI,YACnDN,eAASrB,aCbV4B,oGACW5B,2BAAAA,uBACRA,KAAOA,OACPC,MAAQ,yDAENC,EAAMC,QACRF,MAAMG,KAAKD,yEAELH,2BAAAA,sBACL6B,EAAY7B,EAAKU,MACnBJ,EAAQ,GACC,SAAPa,EAAQW,EAAKC,OACb5B,EAAOI,EAAKN,MAAMK,OACjBH,SACI0B,eAAa7B,GAER,IAAVM,EACFH,eAAQH,UAAMmB,KAEdhB,EAAK4B,EAAMZ,GAEbb,IAEFa,YCvBEa,mCACQhC,gCACLA,KAAOA,OACPC,MAAQ,oDAEXC,EAAMC,QACHF,MAAMG,KAAKD,6DAEVH,2BAAAA,kBACNA,EAAOA,EAAKiC,MAAM,EAAGpB,KAAKb,KAAKQ,YAEpB0B,EAAPC,EAAI,IAEL,OACDD,UAAWjC,OAAMkC,gCAAQnC,WACjBkC,GAAOC,EAAItB,KAAKZ,MAAMO,iBCf9B4B,+BACQpC,gCACLA,KAAOA,OACPC,MAAQ,oDAEXC,EAAMC,QACHF,MAAMG,KAAKD,6DAEVH,2BAAAA,uBACDC,MAAMU,QAAQ,SAAAR,UAAQA,eAAQH,cCTjCqC,mCACQrC,gCACLA,KAAOA,OACPC,MAAQ,oDAEXC,EAAMC,QACHF,MAAMG,KAAKD,6DAEVH,2BAAAA,kBACN0B,QAAQC,IAAId,KAAKZ,MAAOD,QACnBC,MAAMU,QAAQ,SAAA2B,QAIDC,MADRD,eAAMtC,iBCbdwC,wCACQxC,gCACLA,KAAOA,OACPC,MAAQ,oDAEXC,EAAMC,QACHF,MAAMG,KAAKD,6DAEVH,2BAAAA,kBACNA,EAAOA,EAAKiC,MAAM,EAAGpB,KAAKb,KAAKQ,uBAEJK,KAAKZ,OAAzBoB,kBAEAC,OAAO,SAACmB,EAAOH,UACbA,EAAGG,IACTpB,kCAASrB,cCAhB0C,QAAQC,YAAa,EACrBD,QAAQ3C,kBAAoBA,kBAC5B2C,QAAQ9B,yBAA2BA,yBACnC8B,QAAQzB,gBAAkBA,gBAC1ByB,QAAQtB,uBAAyBA,uBACjCsB,QAAQd,yBAA2BA,yBACnCc,QAAQV,aAAeA,aACvBU,QAAQN,SAAWA,SACnBM,QAAQL,aAAeA,aACvBK,QAAQF,kBAAoBA"}